{
  "$schema": "http://json-schema.org/draft-07/schema#", 
  "type": "object",
  "title": "Ingest Job",
  "description": "Tracks individual IOC ingestion jobs and their status",
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the job"
    },
    "created_timestamp": {
      "type": "string",
      "format": "date-time", 
      "description": "Timestamp when job was created"
    },
    "error": {
      "type": "string",
      "description": "Error message if job failed"
    },
    "state": {
      "type": "string",
      "enum": ["running", "completed", "failed"],
      "description": "Current state of the job"
    },
    "ioc_type": {
      "type": "string",
      "description": "IOC type being processed by this job (ip, domain, url, email, hash, or all)"
    },
    "parameters": {
      "type": "object",
      "description": "Parameters used for this job",
      "properties": {
        "modified_ts_gt": {
          "type": "string",
          "description": "Modified timestamp greater than filter"
        },
        "modified_ts_lt": {
          "type": "string", 
          "description": "Modified timestamp less than filter"
        },
        "from_update_id": {
          "type": "string",
          "description": "Starting update_id for this job"
        },
        "status": {
          "type": "string",
          "description": "IOC status filter"
        },
        "order_by": {
          "type": "string",
          "description": "Field to order results by"
        }
      },
      "additionalProperties": true
    }
  },
  "required": ["id", "created_timestamp", "state"],
  "additionalProperties": false
}